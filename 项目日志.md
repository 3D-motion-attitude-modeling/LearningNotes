# é¡¹ç›®æ—¥å¿—

## 2022å¹´11æœˆ27æ—¥

**Kinectéƒ¨åˆ†**

* openposeè¿æ¥ç½‘ç»œæ‘„åƒå¤´

  1. æŸ¥çœ‹æ˜¯å¦æœ‰æ‘„åƒå¤´usbé©±åŠ¨ï¼š`ls /dev/v*` å¦‚æœç»“æœå«æœ‰ `/dev/video0` åˆ™æœ‰ã€‚

  2. æŸ¥çœ‹usbä¿¡æ¯ï¼š `lsusb` æŸ¥çœ‹å“ªä¸€ä¸ªæ˜¯è¿æ¥çš„æ‘„åƒå¤´ã€‚

     ç»æŸ¥ï¼Œkinectæ‘„åƒå¤´IDä¸º `045e:097a~e` 

* ä½¿ç”¨openposeæ¨¡å‹

  * https://github.com/CMU-Perceptual-Computing-Lab/openpose/blob/master/doc
  * cmdæ–¹æ³•ï¼šåœ¨ `~/3d_motion/openpose/openpose` ç›®å½•ä¸‹è¾“å…¥å‘½ä»¤ï¼Œæ³¨æ„é€€å‡ºcondaï¼š `conda deactivate`
  * å¾—åˆ°å§¿æ€ç‚¹ï¼ˆ2dï¼‰ï¼šä¿å­˜ä¸º `.json` æ–‡ä»¶ï¼Œæ³¨æ„ä¸“é—¨å‡†å¤‡ä¸€ä¸ªæ–‡ä»¶å¤¹å­˜æ”¾ï¼Œå› ä¸ºå®ƒä¼šä¿å­˜æ¯ä¸€å¸§çš„å§¿æ€ç‚¹ã€‚

* linuxç³»ç»Ÿå¡æ­»

  `ctrl+alt+T` æ‰“å¼€ä¸€ä¸ªæ–°çš„å‘½ä»¤è¡Œï¼Œè¾“å…¥ `sudo pkill Xorg` æ³¨é”€æ¡Œé¢ï¼Œé‡æ–°ç™»é™†ç”¨æˆ·å³å¯ã€‚**ä¸è¦ç›´æ¥é‡å¯ï¼ï¼** 

## 2023å¹´2æœˆ17æ—¥

**Kinectéƒ¨åˆ†**

* å¼€å¯kinectæ—¶éœ€è¦ç®¡ç†å‘˜æƒé™ï¼ `sudo k4aviewer`

  å¦åˆ™ä¼šæŠ¥é”™ `Is the device being used by another application?`

* Kinect ä½¿ç”¨çš„ä¸»è¦æ–‡ä»¶çš„å®‰è£…ä½ç½®

  * `k4aviewer  /usr/bin/k4aviewer `
  * `k4a.h /usr/include/k4a/k4a.h`

## 2023å¹´2æœˆ18æ—¥

### **Kinect SDKå®‰è£…**

* è¿›å±•ï¼šå®‰è£…äº†é™„å¸¦ example çš„ Kinect SDKæºç ï¼› ä½¿ç”¨ cmake æˆåŠŸç¼–è¯‘ç¤ºä¾‹ç¨‹åºã€‚
* å®‰è£… Kinect SDK æºç ï¼šhttp://t.csdn.cn/rRdsC
  * 1.7.2å®‰è£…ninjaä¸€æ­¥ç»™çš„åŸŸåé”™è¯¯ï¼åº”ä¸º`https://github.com/ninja-build/ninja-git`
  * cmakeå‰éœ€è¦æ‰‹åŠ¨ä¸‹è½½ä¸€é¡¹ï¼ˆæ–‡æ¡£ä¸­æœ‰ï¼‰ï¼Œä¸‹è½½å¥½ä¹‹åå†cmakeã€‚æŠ¥é”™æ²¡å…³ç³»ï¼Œåªè¦æ£€æŸ¥ `/extern/libusb` ç­‰æ–‡ä»¶å¤¹ä¸­å·²ç»ä¸‹è½½å¥½æ–‡ä»¶å³å¯è¿›è¡Œåç»­æ­¥éª¤ã€‚
* ç¼–è¯‘ Kinect åº”ç”¨ç¨‹åº
  * åœ¨ `/examples/CMakelists.txt` ä¸­æ·»åŠ  `find_package(k4a REQUIRED)` ç­‰è¯­å¥ï¼ï¼ˆéå¸¸é‡è¦ï¼Œå¦åˆ™cmakeæ—¶ä¼šæŠ¥é”™ï¼šæ‰¾ä¸åˆ° k4a::k4aï¼‰
  * å…³äº cmake çš„æ›´å¤šå†…å®¹è¿˜éœ€å­¦ä¹ ã€‚
* å…¶ä»–
  * é‡åˆ°æŠ¥é”™æ—¶å…ˆè¯•è¯• **sudo** ï¼ï¼
  * è¿è¡Œç¨‹åºæ—¶æ³¨æ„ï¼Œå½“å‰ Kinect çš„ç¼–å·æ˜¯ 0ï¼Œ ä¼ å‚æ—¶ä¸è¦å‡ºé”™ã€‚
  * ä¸‹è½½æ—¶å¡ä½ï¼Œå¯èƒ½æ˜¯ github å´©äº†

---

### **Openpose ç¼–è¯‘é”™è¯¯**

- ä»Šå¤©é‡æ–°ç¼–è¯‘Openposeä»£ç ï¼Œå‡ºç°å¦‚ä¸‹é—®é¢˜ï¼š

  ```
  nvcc fatal : Unsupported gpu architecture 'compute_80' 
  ```

  æŸ¥é˜…èµ„æ–™å¾—çŸ¥ï¼Œæ˜¯å½“å‰ç”µè„‘æ˜¾å¡ç®—åŠ›ä¸æ”¯æŒ8.0ã€‚

  ç»è¿‡æŸ¥æ‰¾[Nvidiaå®˜ç½‘](https://developer.nvidia.com/cuda-gpus)ï¼Œæ˜¾å¡Quadro P4000çš„ç®—åŠ›ä¸º6.1ã€‚

  è§£å†³æ–¹æ³•å‚è€ƒ[ç½‘ç«™](https://blog.csdn.net/haiy2011/article/details/128968934)ï¼Œåœ¨ `openpose/cmake/Cuda.cmake` æ–‡ä»¶å¤¹ï¼Œå°†ä¸æ”¯æŒçš„ç®—åŠ›æ³¨é‡Šæ‰å³å¯ã€‚


- openposeæºä»£ç ç†è§£

  - `std::make_shared <FlirReader> (cameraParameterPath, cameraResolution, undistortImage, std::stoi(producerString));`

    ä¸Šè¿°ä»£ç è¡¨ç¤ºç”Ÿæˆä¸€ä¸ª`shared_ptr` , è¯¥æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªæ•°æ®ç±»å‹ä¸º `FlirReader` çš„æ•°æ®ï¼Œæ‹¬å·å†…ä¸ºå¯¹åº”æ•°æ®çš„æ„é€ å‡½æ•°æ‰€éœ€å‚æ•°ã€‚


  - ```c++
    // If custom user Worker in same thread
    else if (!userInputWs.empty())
    workersAux = mergeVectors(userInputWs, workersAux);
    // If OpenPose producer (same thread)
    else if (datumProducerW != nullptr)
    workersAux = mergeVectors({datumProducerW}, workersAux);
    ```

â€‹			   è¿™è¡Œä»£ç è¡¨æ˜ `userInputWs` å’Œ `{datumProducerW}` ä¸ºåŒä¸€ä¸ªç±»å‹ã€‚

## 2023å¹´2æœˆ19æ—¥

### **Openposeéƒ¨åˆ†â€”â€”3dè§£é‡Šå™¨ç¼–è¯‘**

ä»Šå¤©åœ¨å°è¯•åŠ å…¥ `WITH_3D_RENDERER` å’Œ `WITH_CERES` çš„æ ‡å¿—åé‡æ–°ç¼–è¯‘openposeæºä»£ç ï¼Œé‡åˆ°äº†å¦‚ä¸‹çš„BUGä¿¡æ¯ï¼š

- BUG:  `error: 'integer_sequence' is not a member of  'std'`

  ç»è¿‡æŸ¥è¯¢ä¿¡æ¯ï¼Œå‘ç°æ˜¯å½“å‰å®‰è£…çš„ ceres-solver ç‰ˆæœ¬ä¸åŒ¹é…æ‰€å¯¼è‡´çš„ã€‚å½“ä½¿ç”¨å½“å‰ [å®˜ç½‘](http://ceres-solver.org/installation.html#linux) ä¸‹è½½çš„ç‰ˆæœ¬ï¼ˆ `ceres-solver-2.1.0` ï¼‰å°†å‡ºç°ä¸Šè¿°é—®é¢˜ã€‚

  è§£å†³æ–¹æ³•æ˜¯å®‰è£…æ—§ç‰ˆæœ¬çš„ceres-solver, å¤§è‡´è¿‡ç¨‹ä¸ºå¸è½½æ–°ç‰ˆçš„ceres-solverï¼Œä¹‹åå®‰è£…1.14.0ç‰ˆæœ¬å³å¯ã€‚å…·ä½“æ“ä½œå‚è€ƒ[ç½‘å€](https://blog.csdn.net/qq_41586768/article/details/107541917)ï¼Œå…¶ä¸­ **ç¼–è¯‘ceres_curve_fiiting** æ­¥éª¤ä¸éœ€è¦æ“ä½œ

- WARNING:  åœ¨ä½¿ç”¨cmake guiè¿›è¡Œconfigureæ“ä½œæ—¶ï¼Œå‡ºç°æœ‰å…³`OpenGL_GL_PREFERENCE` çš„warningä¿¡æ¯ã€‚

  `OpenGL_GL_PREFERENCE` åŸå§‹è¢«è®¾ç½®ä¸º "LEGACY", ä½†æ˜¯Openposeæ¨èè®¾ç½®ä¸º â€œGLVNDâ€ã€‚

  æˆ‘ä»¬é‡‡ç”¨çš„è§£å†³æ–¹æ³•æ¯”è¾ƒæš´åŠ›ï¼Œåœ¨ `usr/local/share/cmake-3.25/Modules` ç›®å½•ä¸‹æ‰¾åˆ°ï¼Œ`FindOpenGL.cmake` æ–‡ä»¶ï¼Œå°†å…¶ä¸­å¦‚ä¸‹ä»£ç æ³¨é‡Šæ‰ï¼š

  ```cmake
  set(OpenGL_GL_PREFERENCE "LEGACY")
  if ("x${_OpenGL_GL_POLICY}x" STREQUAL "xx")
  	set(_OpenGL_GL_POLICY_WARN 1)
  endif()
  ```

  å¹¶ä¿®æ”¹ä¸ºï¼š

  ```cmake
  set(OpenGL_GL_PREFERENCE "GLVND")
  ```

  è¿™ç§åšæ³•ä¸æ¨èï¼Œåœ¨warningä¿¡æ¯ä¸­æç¤ºä½¿ç”¨command_policy()æ“ä½œï¼Œä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°æ­£ç¡®çš„ä½¿ç”¨æ–¹æ³•ã€‚

- **BUG:** 

  ```xml
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutSolidSphere'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutDisplayFunc'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutGetModifiers'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutLeaveMainLoop'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutInitWindowPosition'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutSwapBuffers'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutInitWindowSize'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutSolidCone'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutMouseFunc'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutMainLoopEvent'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutPostRedisplay'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutCreateWindow'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutInit'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutKeyboardFunc'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutMotionFunc'
  ../../src/openpose/libopenpose.so.1.7.0: undefined reference to `glutInitDisplayMode'
  collect2: error: ld returned 1 exit status
  examples/deprecated/CMakeFiles/tutorial_api_thread_2_user_input_processing_output_and_datum.bin.dir/build.make:176: recipe for target 'examples/deprecated/tutorial_api_thread_2_user_input_processing_output_and_datum.bin' failed
  make[2]: *** [examples/deprecated/tutorial_api_thread_2_user_input_processing_output_and_datum.bin] Error 1
  CMakeFiles/Makefile2:1176: recipe for target 'examples/deprecated/CMakeFiles/tutorial_api_thread_2_user_input_processing_output_and_datum.bin.dir/all' failed
  make[1]: *** [examples/deprecated/CMakeFiles/tutorial_api_thread_2_user_input_processing_output_and_datum.bin.dir/all] Error 2
  make[1]: *** Waiting for unfinished jobs....
  
  ```

  è¯¥é”™è¯¯äº§ç”Ÿçš„åŸå› ä¸º-lGLU -lGL -lglutæ²¡æœ‰ä¸ç¼–è¯‘å™¨é“¾æ¥ã€‚å‘ç°é”™è¯¯åŸå› æ˜¯é€šè¿‡å‚è€ƒè¯¥[ç½‘ç«™ ](https://community.khronos.org/t/error-undefined-reference/17579)ï¼Œä»¥åŠå’Œ ChatGPT çš„è¯¢é—®ä¸­ç†è§£çš„ã€‚

  ä½†æ˜¯ä¸Šè¿°ç½‘ç«™å¹¶æ²¡æœ‰ç»™å‡ºå¦‚ä½•åœ¨Openposeæºç çš„ç¼–è¯‘ä¸‹ï¼Œå®ç°é“¾æ¥æ“ä½œã€‚é€šè¿‡å‚è€ƒ[gitHubä¸ŠOpenposeçš„Issues](https://github.com/CMU-Perceptual-Computing-Lab/openpose/issues/440)ï¼Œæ‰¾åˆ°è§£å†³é—®é¢˜çš„å…³é”®æ˜¯ä¿®æ”¹Openposeç›®å½•ä¸‹çš„ `CMakeLists.txt` æ–‡ä»¶ï¼Œå°†å¦‚ä¸‹ä»£ç ä»ï¼š

  ```cmake
  if (WITH_3D_RENDERER)
    set(OpenPose_3rdparty_libraries ${OpenPose_3rdparty_libraries} ${GLUT_LIBRARY} ${OPENGL_LIBRARIES})
  endif (WITH_3D_RENDERER) 
  ```

  ä¿®æ”¹ä¸ºï¼š

  ```cmake
  if (WITH_3D_RENDERER)
    set(OpenPose_3rdparty_libraries ${OpenPose_3rdparty_libraries} ${GLUT_LIBRARY} ${OPENGL_LIBRARIES} -lGLU -lGL -lglut)
  endif (WITH_3D_RENDERER) 
  ```

  å³å¯æˆåŠŸé“¾æ¥ã€‚

- åœ¨ä»Šå¤©çš„debugç¯èŠ‚ä¸­ï¼ŒChatGPTè™½ç„¶æ²¡æœ‰ç»™å‡ºä»»ä½•ä¸€ä¸ªå¯ä»¥è§£å†³é—®é¢˜çš„æ–¹æ¡ˆï¼Œä½†æ˜¯é€šè¿‡åˆç†è¥é€ è¯­å¢ƒæè¿°é”™è¯¯ä¿¡æ¯ï¼Œ**å¯ä»¥å¸®åŠ©ç†è§£é—®é¢˜äº§ç”Ÿçš„åŸå› ï¼Œä»¥åŠç›¸å…³é™Œç”Ÿä»£ç æ–‡ä»¶æˆ–æ˜¯é™Œç”Ÿå‘½ä»¤è¡ŒæŒ‡ä»¤**ï¼Œä»è€Œé—´æ¥çš„å¸®åŠ©é—®é¢˜çš„è§£å†³ã€‚

---

åœ¨linuxä¸Šå®‰è£…äº†QQï¼Œç”¨äºå®æ—¶ä¸å¦ä¸€å°è®¾å¤‡è¿›è¡Œä¿¡æ¯é€šè®¯

---

### **ç›¸æœºæ ‡å®šçŸ¥è¯†ç¯‡**

* ç›¸æœºå°†ä¸‰ç»´ä¸–ç•Œä¸­çš„ç‰©ä½“è®°å½•åœ¨äºŒç»´çš„å›¾ç‰‡ä¸­ï¼Œå› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºç›¸æœºæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥æ˜¯ä¸‰ç»´åœºæ™¯ï¼Œè¾“å‡ºä¸ºäºŒç»´å›¾åƒã€‚**ç›¸æœºæ ‡å®š**å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„æ•°å­¦æ¨¡å‹æ¥æè¿°è¿™ä¸ªå‡½æ•°ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å®ƒçš„åå‡½æ•°ï¼Œç”±äºŒç»´å›¾åƒé‡å»ºä¸‰ç»´åœºæ™¯ã€‚

  ![](.\pictures\pictures for kw\ç›¸æœºæ ‡å®šåŸç†.png)

* **åæ ‡ç³»**

  ä¸ºäº†å¾—åˆ°æ•°å­¦æ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åæ ‡ç³»ï¼š

  * **ä¸–ç•Œåæ ‡ç³»(world coordinate system)** ç°å®ä¸–ç•Œçš„ç»å¯¹åæ ‡ç³»ï¼Œä»¥ç°å®ä¸‰ç»´ç©ºé—´ä¸­æŸä¸€ç‚¹ä¸ºåŸç‚¹å»ºç³»ï¼Œæè¿°ç›¸æœºå’Œç‰©ä½“çš„åæ ‡ã€‚ ç”¨ `(Xw, Yw, Zw)` è¡¨ç¤ºåæ ‡å€¼ã€‚

  * **ç›¸æœº(camera)åæ ‡ç³»** ä»¥ç›¸æœºçš„å…‰å¿ƒä¸ºåŸç‚¹çš„åæ ‡ç³»ï¼Œæè¿°ç‰©ä½“ç›¸å¯¹äºç›¸æœºå…‰å¿ƒçš„ä½ç½®ã€‚ç”¨ `(Xc, Yc, Zc)` è¡¨ç¤ºåæ ‡å€¼ï¼Œç›¸æœºçš„å…‰è½´ä¸ºZè½´ï¼ŒXã€Yè½´åˆ†åˆ«å¹³è¡Œäºå›¾åƒåæ ‡ç³»çš„Xã€Yè½´ã€‚

    **å…‰å¿ƒ** å¤§å¤šæ•°ç›¸æœºéƒ½æ˜¯åˆ©ç”¨å°å­”æˆåƒåŸç†ã€‚å°†ç›¸æœºé€é•œç»„æŠ½è±¡ä¸ºä¸€ä¸ªå°å­”æ¨¡å‹ï¼Œå°å­”ä¸­å¿ƒå³ä¸ºå…‰å¿ƒã€‚

  * **å›¾åƒ(image)åæ ‡ç³»** ä»¥CCDå›¾åƒï¼ˆå³ç›¸æœºæ‹æ‘„åˆ°çš„åŸå§‹å›¾åƒï¼‰ä¸­å¿ƒä¸ºåæ ‡åŸç‚¹ï¼Œæè¿°å›¾ç‰‡ä¸­åƒç´ çš„ä½ç½®ã€‚ç”¨ `(x, y)` è¡¨ç¤ºåæ ‡å€¼ï¼Œå•ä½ä¸ºç°å®ç‰©ç†é•¿åº¦ï¼ˆå¦‚æ¯«ç±³ï¼‰ã€‚

  * **åƒç´ (pixel)åæ ‡ç³»** ä»¥æ•°å­—å›¾åƒçš„å·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹ï¼Œæè¿°å›¾ç‰‡ä¸­åƒç´ çš„ä½ç½®ã€‚ç”¨ `(u, v)` è¡¨ç¤ºåæ ‡å€¼ï¼Œå•ä½ä¸ºä¸ªï¼ˆåƒç´ ä¸ªæ•°ï¼‰

    **åŸå§‹å›¾åƒ -> æ•°å­—å›¾åƒ** ç›¸æœºæ‹æ‘„çš„å›¾ç‰‡åŒ…å«è‹¥å¹²åƒç´ ï¼Œæ¯ä¸ªåƒç´ ç‚¹æœ‰å®ƒçš„é¢œè‰²ã€‚æ•°å­—å›¾åƒç”¨æ•°å­—è¡¨ç¤ºæ¯ä¸ªç‚¹çš„é¢œè‰²ã€‚

![](.\pictures\pictures for kw\å›¾åƒåæ ‡ç³»ä¸åƒç´ åæ ‡ç³».png)

* å†…å‚çŸ©é˜µ

  é‡‡ç”¨é½æ¬¡åæ ‡ï¼Œä½¿ç”¨çŸ©é˜µå°†ä¸Šå¼è¡¨ç¤ºä¸º

  ![](.\LearningNotes\pictures\pictures for kw\å›¾åƒåæ ‡ç³»åˆ°åƒç´ åæ ‡ç³».jpg)

  å…¶ä¸­ `(u0, v0)` æ˜¯å›¾åƒåæ ‡ç³»åŸç‚¹åœ¨åƒç´ åæ ‡ç³»ä¸­çš„åæ ‡ï¼ˆç”±ä¸Šè¿°å®šä¹‰å¯çŸ¥ï¼Œåæ ‡ä¸ºå›¾åƒåˆ†è¾¨ç‡çš„ä¸€åŠï¼‰ï¼Œ`dx` å’Œ `dy` åˆ†åˆ«ä¸ºæ¯ä¸ªåƒç´ åœ¨å›¾åƒå¹³é¢å¯¹åº”æ–¹å‘ä¸Šçš„ç‰©ç†å°ºå¯¸ã€‚

  ç›¸æœºåæ ‡ç³»åˆ°å›¾åƒåæ ‡ç³»çš„è½¬æ¢ï¼Œå¦‚ä¸‹å›¾ï¼š

  ![](.\pictures\pictures for kw\ç›¸æœºåæ ‡ç³»åˆ°å›¾åƒåæ ‡ç³».jpg)

  ä¸Šå¼ä¸­XYZä¸ºç‰©ä½“åœ¨ç›¸æœºåæ ‡ç³»ä¸­çš„ä½ç½®ï¼Œä¸ºå…·ä½“æ•°å€¼ã€‚

  ç»“åˆä¸Šè¿°ä¸¤ä¸ªå˜æ¢ï¼Œæˆ‘ä»¬å¾—åˆ°**å†…å‚çŸ©é˜µ**
  $$
  M=
  \begin{bmatrix}
  \frac{1}{dx} & 0 & u0 \\
  0 & \frac{1}{dy} & v0 \\
  0 & 0 & 1
  \end{bmatrix}
  \begin{bmatrix}
  f & 0 & 0 \\
  0 & f & 0 \\
  0 & 0 & 1
  \end{bmatrix}
  =
  \begin{bmatrix}
  f_x & 0 & u0 \\
  0 & f_y & v0 \\
  0 & 0 & 1
  \end{bmatrix}
  $$
  å…¶ä¸­ fxï¼Œfy è¡¨ç¤ºåœ¨ç›¸æœºæ‹æ‘„çš„å›¾åƒä¸­ï¼Œé•¿åº¦ç­‰äºç„¦è· f çš„ä¸€æ®µä¸­åŒ…å«çš„åƒç´ ç‚¹ä¸ªæ•°ã€‚ç§° M ä¸ºå†…å‚çŸ©é˜µï¼Œæ˜¯å› ä¸ºçŸ©é˜µ M çš„å„ä¸ªå…ƒç´ å€¼åªä¸ç›¸æœºå†…éƒ¨å‚æ•°æœ‰å…³ã€‚**åˆ©ç”¨å†…å‚çŸ©é˜µï¼Œå¯ä»¥æ–¹ä¾¿åœ°ä»ç›¸æœºåæ ‡ç³»å˜æ¢åˆ°åƒç´ åæ ‡ç³»ã€‚**

* **å¤–å‚çŸ©é˜µ**

  è¦å¾—åˆ°ä¸–ç•Œåæ ‡ç³»åˆ°åƒç´ åæ ‡ç³»çš„å˜æ¢ï¼Œåˆ™éœ€è¦çŸ¥é“è¿™ä¸¤ä¸ªä¸‰ç»´åæ ‡ç³»ä¹‹é—´çš„ç›¸å¯¹æ—‹è½¬çŸ©é˜µ **R** (3Ã—3)å’Œç›¸å¯¹ä½ç§»çŸ©é˜µ **T** (3Ã—1)ã€‚ç”¨çŸ©é˜µè¡¨ç¤ºå˜æ¢ï¼š

  ![](.\pictures\pictures for kw\å¤–å‚çŸ©é˜µ.png)

  ç»¼ä¸Šï¼Œå³å¯å®ç°å®Œæ•´çš„å˜æ¢ã€‚ä¸Šå¼ä¸­ï¼ŒZ~c~ ä¸ºç‰©ä½“åˆ°å…‰å¿ƒçš„è·ç¦»ï¼Œå³**æ·±åº¦è·ç¦»**ï¼

* **ç•¸å˜æ¨¡å‹**

  å®é™…çš„ç›¸æœºå¹¶ä¸æ˜¯å®Œç¾çš„å°å­”æˆåƒæ¨¡å‹ï¼Œå› æ­¤å®é™…æˆåƒä¼šæœ‰ç•¸å˜ã€‚ç•¸å˜åŒ…æ‹¬**å¾„å‘ç•¸å˜**å’Œ**åˆ‡å‘ç•¸å˜**ç­‰ï¼Œæ˜¯ç”±äºç„¦å¹³é¢ä¸Šä¸åŒåŒºåŸŸå¯¹å›¾åƒçš„æ”¾å¤§ç‡ä¸åŒå½¢æˆçš„ç”»é¢æ‰­æ›²å˜å½¢çš„ç°è±¡ã€‚

  ä½¿ç”¨3ä¸ªç•¸å˜å‚æ•°çŸ«æ­£å¾„å‘ç•¸å˜ï¼ˆåŸç†ï¼šä»¥å…‰å¿ƒä¸ºåœ†å¿ƒï¼Œr=0å¤„æ³°å‹’å±•å¼€å–å‰å‡ é¡¹ï¼‰
  $$
  x_{rcorr}=x_p(1+k_1r^2+k_2r^4+k_3r^6) \\
  y_{rcorr}=y_p(1+k_1r^2+k_2r^4+k_3r^6)
  $$
  ä½¿ç”¨2ä¸ªç•¸å˜å‚æ•°æè¿°åˆ‡å‘ç•¸å˜
  $$
  x_{tcorr}=x_p+[2p_1x_py_p+p_2(r^2+2x_p^2)] \\
  y_{tcorr}=y_p+[p_1(r^2+2y_p^2)+2p_2x_py_p]
  $$

## 2023å¹´2æœˆ21æ—¥

### **å®‰è£… ROS for Azure Kinect DK**

* å®˜ç½‘æ•™ç¨‹ https://github.com/microsoft/Azure_Kinect_ROS_Driver

* å½“å‰ Kinect ç‰ˆæœ¬ä¸º1.4.1

* å®‰è£… ROS å®˜ç½‘æ•™ç¨‹ https://wiki.ros.org/installation/Ubuntu

  è·Ÿç€å®˜ç½‘æ•™ç¨‹ä¼šå‡ºé”™ `Command: 'catkin_make' not found`

* ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼ˆæ¥è‡ª https://blog.csdn.net/haiyinshushe/article/details/84256137ï¼‰

  1. `sudo sh -c '. /etc/lsb-release && echo "deb http://mirrors.ustc.edu.cn/ros/ubuntu/ $DISTRIB_CODENAME main" > /etc/apt/sources.list.d/ros-latest.list'`

  2. `sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-key 421C365BD9FF1F717815A3895523BAEEB01FA116`

     å¦‚æœä¸è¡Œï¼Œä¸­é—´çš„hkpå¯†é’¥éƒ¨åˆ†å¯ä»¥ä½¿ç”¨ `hkp://ha.pool.sks-keyservers.net:80  æˆ–  hkp://pgp.mit.edu:80`

  3. `sudo apt-get update`

  4. `sudo apt-get install ros-melodic-desktop-full`

  5. åˆå§‹åŒ–rosdep

     `sudo apt-get install python-rosdep`

     `sudo rosdep init`

     `rosdep update`

  6. æ·»åŠ rosç¯å¢ƒå˜é‡

     `echo "source /opt/ros/melodic/setup.bash" >> ~/.bashrc
     source ~/.bashrc`

  7. å®‰è£…rosinstall

  è‡³æ­¤ROSå®‰è£…å®Œæˆã€‚

* å®‰è£… Kinect ROS http://t.csdn.cn/rRdsC

  1. ä¸‹è½½ROSé©±åŠ¨

     `mkdir -p ~/KinectDK_ws/src
     cd ~/KinectDK_ws/src
     catkin_init_workspace
     git clone https://github.com/microsoft/Azure_Kinect_ROS_Driver.git`

  2. ä¸‹è½½ libk4a å’Œ libk4a-dev æ–‡ä»¶ï¼ˆç‰ˆæœ¬1.4.1ï¼‰https://packages.microsoft.com/ubuntu/18.04/prod/pool/main/libk/libk4a1.2/

  3. åˆ›å»ºæ–‡ä»¶å¤¹å­˜æ”¾ä¸Šè¿°æ–‡ä»¶

     `cd ~/KinectDK_ws/src
     mkdir -p ext/sdk`

     åœ¨sdkæ–‡ä»¶å¤¹ä¸‹å†åˆ›å»º3ä¸ªæ–‡ä»¶å¤¹ï¼š

     1. binæ–‡ä»¶å¤¹: æŠŠç¼–è¯‘ SDK æ—¶ build æ–‡ä»¶å¤¹é‡Œé¢çš„é‚£ä¸ª bin æ–‡ä»¶å¤¹ç›´æ¥æ‹·è´è¿‡æ¥
     2. includeæ–‡ä»¶å¤¹ï¼šSDK æºç é‡Œçš„includeæ–‡ä»¶å¤¹ä¸ä» deb æ–‡ä»¶é‡Œæå–å‡ºçš„ include æ–‡ä»¶å¤¹åˆå¹¶ï¼Œæ‹·è´è¿‡æ¥
     3. libæ–‡ä»¶å¤¹ï¼šä»debæ–‡ä»¶é‡Œæå–å‡ºçš„ä¸¤ä¸ªlibæ–‡ä»¶å¤¹åˆå¹¶ï¼Œæ‹·è´è¿‡æ¥ **æ³¨æ„ï¼šè¿™é‡Œæ˜¯ä¸¤ä¸ªlibæ–‡ä»¶**

     **æ³¨ï¼šæ‰“å¼€debæ–‡ä»¶çš„æ–¹æ³•** ä¸è¦è§£å‹ï¼Œå³é”®é€‰æ‹© `Open with other application` å†é€‰æ‹© `Archive Manager`

  4. ç¼–è¯‘åŠå¯ç”¨

     `cd ~/KinectDK_ws
     catkin_make
     catkin_make install
     source ./devel/setup.bash
     roslaunch azure_kinect_ros_driver driver.launch `

     `rviz`

     catlin_make install ä¸€æ­¥ä¼šæŠ¥é”™ï¼ŒåŸå› ä¸æ˜ã€‚ä¸ä¼šå½±å“åç»­æ“ä½œï¼ˆä¹Ÿè®¸ï¼‰

     **roslunch ä¸€æ­¥è‹¥æŠ¥é”™ï¼Œå°†kinecté‡å¯å³å¯**

  * é”™è¯¯æ±‡æ€»

    `rviz` éœ€è¦åœ¨å¦ä¸€ä¸ªå‘½ä»¤è¡Œä¸­å¼€å¯ï¼ˆroslaunchéœ€å¤„äºè¿è¡ŒçŠ¶æ€ï¼‰ï¼ŒåŒæ—¶é€€å‡ºcondaç¯å¢ƒï¼

## 2023å¹´2æœˆ25æ—¥

### ä½¿ç”¨ Ros æ ‡å®š Kinect ç›¸æœº

* å‚è€ƒæ–‡ç«  http://t.csdn.cn/zQKpg

* è¯¦ç»†æ­¥éª¤

  * å¼€å¯ ros å¯è§†åŒ–çª—å£

    `cd ~/KinectDK_ws
    catkin_make
    catkin_make install
    source ./devel/setup.bash
    roslaunch azure_kinect_ros_driver driver.launch `

    ç„¶åå¼€å¯å¦ä¸€ä¸ªå‘½ä»¤è¡Œ

    `rviz`

  * æ˜¾ç¤º Kinect ç›¸æœºå›¾åƒ

    `Add -> Image -> Image Topic -> /rgb/image_raw`

    ï¼ˆä¸Šé¢æ˜¯æ˜¾ç¤ºRGBå›¾åƒçš„ä¾‹å­ï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºæ·±åº¦å›¾åƒç­‰ï¼‰

  * å®‰è£… ros æ ‡å®šåŒ…

    `sudo apt-get install ros-melodic-camera-calibration`

  * ç›¸æœºæ ‡å®š

    `rosrun camera_calibration cameracalibrator.py --size 8x6 --square 0.024 image:=/rgb/image_raw`


* ç”¨ openpose æ ‡å®šç›¸æœº

  * æŸ¥çœ‹ webcam `v4l2-ctl --list-devices`

  * å®˜æ–¹æ•™ç¨‹ [openpose/calibration_module.md at master Â· CMU-Perceptual-Computing-Lab/openpose Â· GitHub](https://github.com/CMU-Perceptual-Computing-Lab/openpose/blob/master/doc/advanced/calibration_module.md#introduction)

    **æ³¨æ„ï¼šæ ‡å®šæ—¶éœ€è¦æ‹æ‘„è¶³å¤Ÿçš„ç…§ç‰‡ï¼ˆè‡³å°‘çº¦150å¼ ï¼‰ï¼Œå¦åˆ™æ— æ³•äº§ç”Ÿæ ‡å®šç»“æœï¼Œä¼šæŠ¥é”™**  `image could not be opened!`

  * æ ‡å®šï¼šåœ¨ `/openpose/openpose` ä¸‹

    `../openpose/build/examples/calibration/calibration.bin --mode 1 --grid_square_size_mm 20.0 --grid_number_inner_corners "8x6" --camera_serial_number 18079958 --calibration_image_dir ../intrinsic/ --camera_parameter_folder models/cameraParameters/`

### ä¿®æ”¹Openposeæºç ï¼ŒåŠ å…¥KinectCameraæ ‡å¿—

å°è¯•ä¿®æ”¹Openposeæºç ï¼Œè¿›è¡Œå†ç¼–è¯‘ï¼Œå®ç°è¿‡ç¨‹ä¸­å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š

- ç¼–è¯‘é”™è¯¯ï¼š`Syntax error: "(" unexpected` 

  å°†æºç æ–‡ä»¶å¤¹åä» `Openpose(copy)` æ”¹ä¸º  `Openpose-copy` å³å¯

- ç¼–è¯‘é”™è¯¯ï¼š

  ```xml
  error: â€˜FLAGS_kinect_cameraâ€™ was not declared in this scope
               FLAGS_flir_camera, FLAGS_flir_camera_index, FLAGS_kinect_camera, FLAGS_kinect_camera_index);
  ```

  C++å‘½ä»¤è¡Œè§£æåŒ… gflags ä½¿ç”¨é—®é¢˜ã€‚åœ¨`include\openpose\flags.hpp` ä¸­åŠ å…¥å¯¹æ–°flagçš„å®šä¹‰å³å¯ã€‚[å‚è€ƒç½‘é¡µ](https://gohalo.me/post/package-gflags-usage.html)

## é¡¹ç›®å°å­˜ï¼ˆ2023å¹´3æœˆ12æ—¥ï¼‰

- **å·²å®Œæˆçš„ä»»åŠ¡**

  1. å®Œæˆäº†Openposeåœ¨linuxç³»ç»Ÿä¸Šï¼ŒåŠ å…¥3Dè§£é‡Šå™¨åçš„æºç ç¼–è¯‘

  2. åˆæ­¥ä¿®æ”¹Openposeæºç ï¼Œä½¿å¾—å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤è¡Œï¼ŒæŒ‰æŒ‡å®šæ–¹å¼ï¼ˆä½¿ç”¨Kinectç›¸æœºä»£æ›¿Flirç›¸æœºè¯»å–æ•°æ®ï¼‰è¿è¡Œç¨‹åº

     ```
     ./build/examples/openpose/openpose.bin --kinect_camera
     ```

     å‘½ä»¤è¡Œå‰ä¸ºç¼–è¯‘`openpose.cpp`å®Œæˆåçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåä¸ºæŒ‡å®šçš„FLAGå‚æ•°ã€‚

     å…·ä½“ä»£ç ä¿®æ”¹å¯å‚çœ‹GitHubçš„projectä»“åº“çš„æ›´æ–°è®°å½•ã€‚

     ---

  3. å®‰è£… **Azure Kinect SDK**ï¼ŒåŒ…æ‹¬æŸ¥çœ‹å™¨ä¸ç”¨äºåç»­å¼€å‘çš„åŒ…ã€‚

  4. è¿è¡Œç¤ºä¾‹ç¨‹åºï¼Œèƒ½å¤Ÿé€šè¿‡è°ƒç”¨ **k4a** åŒ…ä¸­çš„å‡½æ•°å®ç°ç›¸æœºæ•°æ®çš„è¯»å–ï¼Œå¦‚å†…å‚ã€ç‚¹äº‘ä¿¡æ¯ç­‰ã€‚

  5. å®‰è£… **ROS** ç³»ç»Ÿï¼Œç”¨äºè¿›ä¸€æ­¥å¼€å‘ã€‚

  6. ä½¿ç”¨ **ROS** å’Œ **openpose** åˆ†åˆ«æ ‡å®š Kinect æ‘„åƒå¤´ã€‚

- **ä¹‹åçš„ä»»åŠ¡**

  1. å®ŒæˆKinectReaderçš„ç¼–å†™ï¼Œä½¿å¾—å¯ä»¥ç”¨Kinectä»£æ›¿Flirç›¸æœºå®Œæˆ3Dé‡å»ºä»»åŠ¡ï¼Œ**ä»£ç å„ä¸ªå‡½æ•°çš„å®ç°æ€è·¯å¯å‚è€ƒGitHubçš„projectä»“åº“æœ€æ–°çš„æ›´æ–°è®°å½•**ã€‚You Can Do Itï¼

  2. æŒ‰è®¡åˆ’è¯»å–Openposeè¾“å‡ºçš„å…³é”®ç‚¹çš„åæ ‡ï¼Œå¹¶é€šè¿‡ä¸ä¸Šå¤§å­¦é•¿äº¤æµï¼Œé¦–å…ˆå®ç°äºŒç»´å…³é”®ç‚¹åˆ°ä¸‰ç»´ç©ºé—´å…³é”®ç‚¹çš„æ˜ å°„ã€‚

  3. å®ç°é«˜æ•ˆçš„ä¸‰ç»´å…³é”®ç‚¹åæ ‡è¿½è¸ªï¼Œä½¿ç”¨å¡å°”æ›¼æ»¤æ³¢è§‚æµ‹å™¨å‡å°è·Ÿè¸ªè¯¯å·®

  4. å¼•å…¥éª¨éª¼æ¡†æ¶çš„çº¦æŸï¼Œé…åˆå…³é”®ç‚¹çš„è¿½è¸ªå…ˆå®ç°ä¸€ä¸ªæ‰‹è‡‚è¿åŠ¨çš„3Dé‡å»º

     ---

  5. å¼€å‘ Kinect æ—¶ï¼Œä¸ºäº†å°†æºä»£ç æ–‡ä»¶é“¾æ¥åˆ°å¯¹åº”çš„å¤´æ–‡ä»¶ï¼ˆä½äºï¼‰ï¼Œéœ€è¦ç¼–å†™ **CMakefile** æ–‡æ¡£ã€‚

  6. åœ¨ **openpose** ä¸­æ¥å…¥ Kinect çš„æ¥å£ï¼ˆå¦‚ k4aï¼‰ï¼Œä»è€Œèƒ½å¤Ÿåˆ©ç”¨ openpose ç›´æ¥è°ƒç”¨ Kinect SDK çš„å‡½æ•°ã€‚

- **é‡è¦æ–‡ä»¶çš„å®‰è£…ä½ç½®ä¸ä½¿ç”¨æ–¹æ³•**

  1. Openposeæºç ç¼–è¯‘

     åœ¨å®Œæˆæ–°ä»£ç çš„ç¼–å†™åï¼Œä½¿ç”¨ cmake å·¥å…·åœ¨ `openpose-copy\build` æ–‡ä»¶å¤¹ä¸‹å®ŒæˆConfigureä¸Generateï¼Œå‘½ä»¤ä¸ºï¼š

     ```
     cmake-gui ..
     ```

     ä¹‹åä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œå®Œæˆç¼–è¯‘ï¼š

     ```
     make -j`nproc`
     ```

  2. ç½‘å¡é©±åŠ¨å®‰è£…

     å‚è€ƒç›®å½• `~/3d_motion/config/EW-7611ULB_Linux_Driver_1.0.1.2` ä¸‹çš„æ“ä½œè¯´æ˜å³å¯ã€‚

  
  3. æ‰“å¼€ Kinect æŸ¥çœ‹å™¨ï¼šåœ¨ä»»æ„ä½ç½® `sudo k4aviewer`
  
  4. é¡¹ç›®çš„æ ¹ç›®å½• `/home/threed_motion/3d_motion` ï¼Œä¸‹å±æ–‡ä»¶å¤¹ï¼š
     1. Azure-Kinect-Sensor-SDKï¼šSDK çš„å®‰è£…ä½ç½®ã€‚
     2. åœ¨ `./include/k4a/k4a.h` ä¸­å¯ä»¥æŸ¥çœ‹ Kinect æ‘„åƒå¤´ä½¿ç”¨çš„å‡½æ•°ã€‚
     3. åœ¨ `./examples`ä¸­å¯ä»¥æŸ¥çœ‹ç¤ºä¾‹ç¨‹åºã€‚åœ¨ç¤ºä¾‹ç¨‹åºæ‰€åœ¨æ–‡ä»¶å¤¹ä¸‹ `cmake` æ¥ç¼–è¯‘æ–‡ä»¶ï¼Œç„¶åä¾ç…§ readme è¿è¡Œã€‚
     4. KinectDK_wsï¼šROS çš„å®‰è£…ä½ç½®ã€‚
        * ä½¿ç”¨ ROSï¼š[æˆ³è¿™é‡Œ](#2023/2/21)
        * ä½¿ç”¨ ROS æ ‡å®šæ‘„åƒå¤´ï¼š[æˆ‘æ¥è¾£](#2023/2/25)
  
  5. KinectProgram ä¸ KinectVideo
  
     å­˜æ”¾ç¼–å†™çš„ Kinect ç¨‹åºä¸æ‹æ‘„çš„ Kinect è§†é¢‘çš„åœ°æ–¹ã€‚

## å¯åŠ¨ï¼ˆ2023å¹´10æœˆ1æ—¥ï¼‰

### openposeä¸‰ç»´é‡å»º

å…³é”®ä»£ç ï¼š

```c++
namespace op
{
    /**
     * 3D triangulation given known camera parameter matrices and based on linear DLT algorithm.
     * The returned cv::Mat is a 4x1 matrix, where the last coordinate is 1.
     */
    double triangulate(
        cv::Mat& reconstructedPoint, const std::vector<cv::Mat>& cameraMatrices,
        const std::vector<cv::Point2d>& pointsOnEachCamera);

    /**
     * 3D triangulation given known camera parameter matrices and based on linear DLT algorithm with additional LMA
     * non-linear refinement.
     * The returned cv::Mat is a 4x1 matrix, where the last coordinate is 1.
     * Note: If Ceres is not enabled, the LMA refinement is skipped and this function is equivalent to triangulate().
     */
    double triangulateWithOptimization(
        cv::Mat& reconstructedPoint, const std::vector<cv::Mat>& cameraMatrices,
        const std::vector<cv::Point2d>& pointsOnEachCamera, const double reprojectionMaxAcceptable);
}
```

é‡å»ºæ–¹æ³•ï¼š

DLT çº¿æ€§é‡å»º [DLT ç›´æ¥çº¿æ€§è½¬æ¢ç®—æ³• | Wayland's Blog (waylandwong.github.io)](https://waylandwong.github.io/dlt/)

### é‡å†™kinectWrapperç±»

å‚è€ƒå¦‚ä¸‹é“¾æ¥ï¼Œä½¿ç”¨ `k4a.h` åº“é‡å†™ `kinectWrapper.cpp` ã€‚

å®‰è£…ç¼–è¯‘æŒ‡å—ï¼š[GitHub - microsoft/Azure-Kinect-Sensor-SDK: A cross platform (Linux and Windows) user mode SDK to read data from your Azure Kinect device.](https://github.com/Microsoft/Azure-Kinect-Sensor-SDK)

åº“çš„å‚è€ƒæ–‡æ¡£ï¼š[Azure Kinect Sensor SDK: Reference (microsoft.github.io)](https://microsoft.github.io/Azure-Kinect-Sensor-SDK/master/modules.html)

åŒæ­¥Kinectè¯»å–å‚è€ƒï¼š

[åŸºäºKinect Azureçš„å¤šç›¸æœºæ•°æ®é‡‡é›†ï¼ˆä¸€ï¼‰_å¤šæ‘„åƒå¤´åŒæ­¥é‡‡é›†-CSDNåšå®¢](https://blog.csdn.net/qq_43707919/article/details/109340757)

[åŸºäºKinect Azureçš„å¤šç›¸æœºæ•°æ®é‡‡é›†ï¼ˆäºŒï¼‰_kinectç›¸æœºæ•°æ®è·å–-CSDNåšå®¢](https://blog.csdn.net/qq_43707919/article/details/109347961)

[åŒæ­¥å¤šä¸ª Azure Kinect DK è®¾å¤‡ | Microsoft Learn](https://learn.microsoft.com/zh-cn/azure/kinect-dk/multi-camera-sync)ï¼ˆå­˜åœ¨éœ€è¦åœ¨è½¯ä»¶ä¸Šè€ƒè™‘çš„å½±å“å½“å‰åŒæ­¥çŠ¶æ€çš„å› ç´ ï¼‰

- åœ¨Linuxä¸Šå®‰è£…Azure Kinect Sensor SDKæ—¶ï¼Œé€šè¿‡å¦‚ä¸‹è®¾ç½®ä¿è¯ç›¸æœºè®¾å¤‡å¯ä»¥ä¸åœ¨rootæƒé™ä¸‹è¿è¡Œç¨‹åºã€‚

  On Linux, once attached, the device should automatically enumerate and load all drivers. However, in order to use the Azure Kinect SDK with the device and without being 'root', you will need to setup udev rules. We have these rules checked into this repo under 'scripts/99-k4a.rules'. To do so:

  - Copy 'scripts/99-k4a.rules' into '/etc/udev/rules.d/'.
  - Detach and reattach Azure Kinect devices if attached during this process.

  Once complete, the Azure Kinect camera is available without being 'root'.

  ä¹Ÿè®¸æˆ‘å¯ä»¥ç†è§£ä¸ºä¸éœ€è¦æ·»åŠ sudoå°±å¯ä»¥è¿è¡Œæ‘„åƒå¤´çš„é©±åŠ¨ç¨‹åºæˆ–åŒ…å«æœ‰æ‘„åƒå¤´é©±åŠ¨åŒ…çš„ç¨‹åºï¼Œç›¸æ¯”ä¹‹ä¸‹é¥æ“ä½œæ†çš„ç¨‹åºæ˜¯éœ€è¦æ·»åŠ `sudo` å‘½ä»¤æ‰å¯ä»¥è¿è¡Œçš„ã€‚

- éœ€è¦åœ¨Kinect SDKä¸­æ‰¾åˆ°çš„å¯¹åº”å…ƒç´ ï¼š

  å…³é”®æŒ‡é’ˆï¼š

  - systemæŒ‡é’ˆï¼ˆç”¨äºæ§åˆ¶æ•´ä¸ªç›¸æœºç³»ç»Ÿï¼‰
    - GetCamerasï¼šè·å–ç›¸æœºåˆ—è¡¨
    - GetInstance(); ä¸ ReleaseInstance();ï¼šå®ä¾‹åŒ–
  - CameraæŒ‡é’ˆï¼ˆç”¨äºæ§åˆ¶å•ä¸ªç›¸æœºï¼‰
    - GetNextImage()ï¼šè·å–å›¾ç‰‡
    - GetNodeMap()ï¼šè·å–æ¯ä¸ªç›¸æœºçš„ GenICam èŠ‚ç‚¹æ˜ å°„ï¼Œç›¸å½“äºä¸€ä¸ªæ£€ç´¢å„ä¸ªç›¸æœºå‚æ•°çš„æŒ‡é’ˆ
    - Init()ï¼šåˆå§‹åŒ–
    - BeginAcquisition();ï¼šå¼€å§‹é‡‡é›†
    - EndAcquisition();ï¼šåœæ­¢é‡‡é›†
    - DeInit();ï¼šå»åˆå§‹åŒ–

  - ImageæŒ‡é’ˆï¼ˆç”¨äºå­˜æ”¾ç›¸æœºé‡‡é›†åˆ°çš„å›¾ç‰‡ï¼‰

    - convertï¼šå›¾åƒæ ¼å¼çš„è½¬æ¢
    - getXPaddingï¼šè·å–å›¾åƒåç§»
    - getwidthï¼šè·å–å›¾åƒå®½
    - getDataï¼šè·å–å›¾åƒæ•°æ®
    - GetStrideï¼šå›¾åƒæ•°æ®çš„æ­¥å¹…ï¼Œå³æ¯è¡Œæ•°æ®çš„å­—èŠ‚æ•°
    - IsIncompleteï¼šæ£€æŸ¥å®Œæ•´æ€§
    - GetImageStatusï¼šè·å–çŠ¶æ€

  - iNodeMapæŒ‡é’ˆï¼ˆè·å–å¹¶è®¾ç½®ç›¸æœºå‚æ•°ï¼‰

### åŒæ­¥è®¾ç½®

- k4a_device_get_sync_jack() å‡½æ•°å¯ä»¥æ£€æŸ¥è®¾å¤‡åŒæ­¥çº¿çš„è¿æ¥æƒ…å†µ
- k4a_device_configuration_t::wired_sync_mode è¯¥å‚æ•°å¯ä»¥è®¾è®¡ç›¸æœºçš„ä¸»ä»æ¨¡å¼
- k4a_device_get_capture() å‡½æ•°å¯ä»¥ä»ç›¸æœºä¸­è¯»å–å›¾ç‰‡åˆ°ä¸€ä¸ª capture_handle çš„ Buffer ä¸­

## 2023å¹´10æœˆ8å·

* ### é‡æ–°å®‰è£…Ubuntu 18.04ç³»ç»Ÿï¼š

  * ä¸‹è½½ä¸€ä¸ªubuntuç³»ç»Ÿé•œåƒåˆ°Uç›˜ä¸­
  * ç”¨Rufusè½¯ä»¶åˆ¶ä½œå¯åŠ¨ç›˜
  * è®¡ç®—æœºå¼€æœºæ—¶é€‰æ‹©Uç›˜å¯åŠ¨ï¼šå…ˆæŒ‰enter/f1/f12ç­‰é”®è¿›å…¥biosæ¨¡å¼ï¼Œç¦ç”¨æ‰secure bootï¼Œç„¶åé€€å‡ºbiosæ¨¡å¼åœ¨startupä¸­æ‰¾åˆ°Uç›˜å³å¯ï¼Œ**é‡‡ç”¨UEFIæ–¹å¼å®‰è£…è¾ƒå¥½**
  * å®‰è£…Ubuntu

* æ¢å¤2022.11.27çš„ç³»ç»Ÿå¤‡ä»½

  â€”â€”â€”â€”â€”â€”â€”ç´§æ€¥æƒ…å†µâ€”â€”â€”â€”â€”â€”â€”

  æ¢å¤å¤‡ä»½ä¹‹åç³»ç»Ÿä¸­å¤šå‡ºäº†ä¸€ä¸ªç”¨æˆ·ï¼Œå‡ºç°äº†æœªçŸ¥é”™è¯¯ï¼Œå´©ä¸ä½äº†ï¼

  é‡æ–°åˆ¶ä½œå¯åŠ¨ç›˜ï¼Œé‡æ–°å®‰è£…ï¼ï¼ï¼

  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

* é‡æ–°å®‰è£…ä¹‹åï¼Œå…ˆç”¨ç½‘çº¿è¿æ¥ç½‘ç»œï¼

  * å®‰è£…åŸºæœ¬ä¾èµ–ï¼ˆä»£æ›¿åŸå…ˆæ¢å¤å¤‡ä»½çš„æ­¥éª¤ï¼Œç›´æ¥é‡æ–°å¼€å§‹ï¼ï¼‰ï¼š
    * sudo apt upgrade
    * sudo apt install build-essential
    * sudo apt install cmake

* å®‰è£…æ— çº¿ç½‘å¡é©±åŠ¨ï¼ˆä»…é€‚ç”¨äºå½“å‰å‹å·ç½‘å¡ï¼šrealtek 8821cuï¼‰ï¼š

  https://gitcode.net/mirrors/maxhw/rtl8821cu?utm_source=csdn_github_accelerator

  é…ç½®æ— çº¿ç½‘ç»œï¼š

  https://blog.csdn.net/weixin_40358083/article/details/82864220

* å®‰è£…æ˜¾å¡é©±åŠ¨ï¼šhttps://blog.csdn.net/weixin_44348719/article/details/125049064

  * æŸ¥çœ‹æ˜¾å¡å‹å·ï¼šæ­¤å¤„å¾—åˆ°çš„æ˜¾å¡ä¸º GeForce RTX 3080 Lite Hash Rate
  * `sudo apt-get install lightdm` ä¸€æ­¥ï¼Œä¼šå‡ºç°ä¸€ä¸ªå›¾å½¢ç•Œé¢ï¼Œé€‰æ‹©lightdmå³å¯ã€‚
  * åœ¨ç¬¬å››æ­¥è¿›å…¥ttyæ¨¡å¼åï¼Œéœ€è¦å†æ¬¡è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œè®°å¾—**æå‰è®°ä½ç”¨æˆ·å**ã€‚

* å®‰è£…teamviewerï¼šå®˜ç½‘ä¸‹è½½å³å¯ã€‚[Linux (teamviewer.cn)](https://www.teamviewer.cn/cn/download/linux/)

ä»Šæ—¥ä»»åŠ¡å®Œæˆ  åˆå›åˆ°æœ€åˆçš„èµ·ç‚¹ğŸ¶~

* å†æ¬¡å¤‡ä»½ï¼šhttps://blog.csdn.net/amnesiagreen/article/details/104572812


## 2023å¹´10æœˆ9å·

### é‡æ–°å®‰è£…kinect SDKï¼š

å‚è€ƒç½‘ç«™ï¼šhttps://learn.microsoft.com/zh-cn/azure/kinect-dk

* é¦–å…ˆè¦ä¸‹è½½å‡ ä¸ªä¾èµ–åŒ…ï¼Œè¯¦è§æ•™ç¨‹ï¼š[Ubuntu20.04å’Œ22.04é…ç½®Azure Kinect Sensor SDK-CSDNåšå®¢](https://blog.csdn.net/OTZ_2333/article/details/124025953)

  ä¸‹è½½å¥½ `libk4a1.4_1.4.1_amd64.deb` `libk4a1.4-dev_1.4.1_amd64.deb` `k4a-tools_1.4.1_amd64.deb`ä¹‹åï¼Œæ”¾å…¥é¡¹ç›®ä¸‹åŒä¸€æ–‡ä»¶å¤¹ï¼Œä¾æ¬¡è§£å‹å³å¯ã€‚æ³¨æ„ï¼šè§£å‹k4a-toolsçš„æ—¶å€™éœ€è¦å…ˆ `apt install libsoundio1`

* æµ‹è¯•ä¸€ä¸‹ï¼Œè¾“å…¥ `k4aviewer` å³å¯æ‰“å¼€æ‘„åƒå¤´ã€‚

### openposeä¾èµ–å®‰è£…

* å®‰è£…CUDAï¼šhttps://blog.csdn.net/my__blog/article/details/125720601 æ­¤å¤„ä¸‹è½½çš„æ˜¯CUDA11.8

* å®‰è£…cudnnï¼š

  ä¸‹è½½debï¼š https://developer.nvidia.com/rdp/cudnn-download

  å®‰è£…ï¼š

  ```bash
  sudo dpkg -i cudnn-local-repo-ubuntu1804-8.9.4.25_1.0-1_amd64.deb 
  sudo apt-get update
  cd /var/cudnn-local-repo-ubuntu1804-8.9.4.25/
  sudo dpkg -i libcudnn8_8.9.4.25-1+cuda11.8_amd64.deb
  sudo dpkg -i libcudnn8-dev_8.9.4.25-1+cuda11.8_amd64.deb 
  sudo dpkg -i libcudnn8-samples_8.9.4.25-1+cuda11.8_amd64.deb 
  ```

  æµ‹è¯•å®‰è£…æ˜¯å¦æˆåŠŸ(åˆ›å»ºä¸€ä¸ªç©ºé—²æ–‡ä»¶å¤¹å¹¶è¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œä¸‹è¿°æ“ä½œ)ï¼š

  ```bash
  cp -r /usr/src/cudnn_samples_v8/ ./
  cd cudnn_samples_v8/mnistCUDNN/
  sudo make clean
  sudo make
  ```

  æŠ¥é”™åŠè§£å†³ï¼š

  ```
  ERROR:
  test.c:1:10: fatal error: FreeImage.h: No such file or directory
   #include "FreeImage.h"
  
  SOLVE:
  (https://lequ7.com/guan-yu-ubuntu2004ubuntu2004-xian-ka-qu-dong-cudacudnn-guan-wang-an-zhuang-jiao-cheng.html) â€”â€” å®‰è£…ç¼ºå°‘çš„ä¾èµ–
  sudo apt-get install g++ freeglut3-dev build-essential libx11-dev libxmu-dev libxi-dev libglu1-mesa libglu1-mesa-dev
  sudo apt-get install libfreeimage3 libfreeimage-dev
  ```

  
